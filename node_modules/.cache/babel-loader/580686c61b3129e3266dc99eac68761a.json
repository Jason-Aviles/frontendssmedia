{"ast":null,"code":"import _objectWithoutProperties from\"/Users/jasonaviles/Desktop/facebook/starter/frontendssmedia/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";import _asyncToGenerator from\"/Users/jasonaviles/Desktop/facebook/starter/frontendssmedia/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"/Users/jasonaviles/Desktop/facebook/starter/frontendssmedia/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/jasonaviles/Desktop/facebook/starter/frontendssmedia/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/jasonaviles/Desktop/facebook/starter/frontendssmedia/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";var _excluded=[\"message\"];import _regeneratorRuntime from\"/Users/jasonaviles/Desktop/facebook/starter/frontendssmedia/node_modules/@babel/runtime/regenerator/index.js\";import{Form,Formik}from\"formik\";import{useState}from\"react\";import RegisterInput from\"../inputs/registerInput\";import*as Yup from\"yup\";import DateOfBirthSelect from\"./DateOfBirthSelect\";import GenderSelect from\"./GenderSelect\";import DotLoader from\"react-spinners/DotLoader\";import axios from\"axios\";import{useDispatch}from\"react-redux\";import Cookies from\"js-cookie\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function RegisterForm(_ref){var setVisible=_ref.setVisible;var dispatch=useDispatch();var navigate=useNavigate();var userInfos={first_name:\"\",last_name:\"\",email:\"\",password:\"\",bYear:new Date().getFullYear(),bMonth:new Date().getMonth()+1,bDay:new Date().getDate(),gender:\"\"};var _useState=useState(userInfos),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var first_name=user.first_name,last_name=user.last_name,email=user.email,password=user.password,bYear=user.bYear,bMonth=user.bMonth,bDay=user.bDay,gender=user.gender;var yearTemp=new Date().getFullYear();var handleRegisterChange=function handleRegisterChange(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;setUser(_objectSpread(_objectSpread({},user),{},_defineProperty({},name,value)));};var years=Array.from(new Array(108),function(val,index){return yearTemp-index;});var months=Array.from(new Array(12),function(val,index){return 1+index;});var getDays=function getDays(){return new Date(bYear,bMonth,0).getDate();};var days=Array.from(new Array(getDays()),function(val,index){return 1+index;});var registerValidation=Yup.object({first_name:Yup.string().required(\"What's your First name ?\").min(2,\"Fisrt name must be between 2 and 16 characters.\").max(16,\"Fisrt name must be between 2 and 16 characters.\").matches(/^[aA-zZ]+$/,\"Numbers and special characters are not allowed.\"),last_name:Yup.string().required(\"What's your Last name ?\").min(2,\"Last name must be between 2 and 16 characters.\").max(16,\"Last name must be between 2 and 16 characters.\").matches(/^[aA-zZ]+$/,\"Numbers and special characters are not allowed.\"),email:Yup.string().required(\"You'll need this when you log in and if you ever need to reset your password.\").email(\"Enter a valid email address.\"),password:Yup.string().required(\"Enter a combination of at least six numbers,letters and punctuation marks(such as ! and &).\").min(6,\"Password must be atleast 6 characters.\").max(36,\"Password can't be more than 36 characters\")});var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),dateError=_useState4[0],setDateError=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),genderError=_useState6[0],setGenderError=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),error=_useState8[0],setError=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),success=_useState10[0],setSuccess=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),loading=_useState12[0],setLoading=_useState12[1];var registerSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$post,data,message,rest;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.post(\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/register\"),{first_name:first_name,last_name:last_name,email:email,password:password,bYear:bYear,bMonth:bMonth,bDay:bDay,gender:gender});case 3:_yield$axios$post=_context.sent;data=_yield$axios$post.data;setError(\"\");setSuccess(data.message);message=data.message,rest=_objectWithoutProperties(data,_excluded);setTimeout(function(){dispatch({type:\"LOGIN\",payload:rest});Cookies.set(\"user\",JSON.stringify(rest));navigate(\"/\");},2000);_context.next=16;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);setLoading(false);setSuccess(\"\");setError(_context.t0.response.data.message);case 16:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return function registerSubmit(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"blur\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"register\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"register_header\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"exit_icon\",onClick:function onClick(){return setVisible(false);}}),/*#__PURE__*/_jsx(\"span\",{children:\"Sign Up\"}),/*#__PURE__*/_jsx(\"span\",{children:\"it's quick and easy\"})]}),/*#__PURE__*/_jsx(Formik,{enableReinitialize:true,initialValues:{first_name:first_name,last_name:last_name,email:email,password:password,bYear:bYear,bMonth:bMonth,bDay:bDay,gender:gender},validationSchema:registerValidation,onSubmit:function onSubmit(){var current_date=new Date();var picked_date=new Date(bYear,bMonth-1,bDay);var atleast14=new Date(1970+14,0,1);var noMoreThan70=new Date(1970+70,0,1);if(current_date-picked_date<atleast14){setDateError(\"it looks like you(ve enetered the wrong info.Please make sure that you use your real date of birth.\");}else if(current_date-picked_date>noMoreThan70){setDateError(\"it looks like you(ve enetered the wrong info.Please make sure that you use your real date of birth.\");}else if(gender===\"\"){setDateError(\"\");setGenderError(\"Please choose a gender. You can change who can see this later.\");}else{setDateError(\"\");setGenderError(\"\");registerSubmit();}},children:function children(formik){return/*#__PURE__*/_jsxs(Form,{className:\"register_form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"reg_line\",children:[/*#__PURE__*/_jsx(RegisterInput,{type:\"text\",placeholder:\"First name\",name:\"first_name\",onChange:handleRegisterChange}),/*#__PURE__*/_jsx(RegisterInput,{type:\"text\",placeholder:\"Surname\",name:\"last_name\",onChange:handleRegisterChange})]}),/*#__PURE__*/_jsx(\"div\",{className:\"reg_line\",children:/*#__PURE__*/_jsx(RegisterInput,{type:\"text\",placeholder:\"Mobile number or email address\",name:\"email\",onChange:handleRegisterChange})}),/*#__PURE__*/_jsx(\"div\",{className:\"reg_line\",children:/*#__PURE__*/_jsx(RegisterInput,{type:\"password\",placeholder:\"New password\",name:\"password\",onChange:handleRegisterChange})}),/*#__PURE__*/_jsxs(\"div\",{className:\"reg_col\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"reg_line_header\",children:[\"Date of birth \",/*#__PURE__*/_jsx(\"i\",{className:\"info_icon\"})]}),/*#__PURE__*/_jsx(DateOfBirthSelect,{bDay:bDay,bMonth:bMonth,bYear:bYear,days:days,months:months,years:years,handleRegisterChange:handleRegisterChange,dateError:dateError})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"reg_col\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"reg_line_header\",children:[\"Gender \",/*#__PURE__*/_jsx(\"i\",{className:\"info_icon\"})]}),/*#__PURE__*/_jsx(GenderSelect,{handleRegisterChange:handleRegisterChange,genderError:genderError})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"reg_infos\",children:[\"By clicking Sign Up, you agree to our\",\" \",/*#__PURE__*/_jsx(\"span\",{children:\"Terms, Data Policy \\xA0\"}),\"and \",/*#__PURE__*/_jsx(\"span\",{children:\"Cookie Policy.\"}),\" You may receive SMS notifications from us and can opt out at any time.\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"reg_btn_wrapper\",children:/*#__PURE__*/_jsx(\"button\",{className:\"blue_btn open_signup\",children:\"Sign Up\"})}),/*#__PURE__*/_jsx(DotLoader,{color:\"#1876f2\",loading:loading,size:30}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error_text\",children:error}),success&&/*#__PURE__*/_jsx(\"div\",{className:\"success_text\",children:success})]});}})]})});}","map":{"version":3,"sources":["/Users/jasonaviles/Desktop/facebook/starter/frontendssmedia/src/components/login/RegisterForm.js"],"names":["Form","Formik","useState","RegisterInput","Yup","DateOfBirthSelect","GenderSelect","DotLoader","axios","useDispatch","Cookies","useNavigate","RegisterForm","setVisible","dispatch","navigate","userInfos","first_name","last_name","email","password","bYear","Date","getFullYear","bMonth","getMonth","bDay","getDate","gender","user","setUser","yearTemp","handleRegisterChange","e","target","name","value","years","Array","from","val","index","months","getDays","days","registerValidation","object","string","required","min","max","matches","dateError","setDateError","genderError","setGenderError","error","setError","success","setSuccess","loading","setLoading","registerSubmit","post","process","env","REACT_APP_BACKEND_URL","data","message","rest","setTimeout","type","payload","set","JSON","stringify","response","current_date","picked_date","atleast14","noMoreThan70","formik"],"mappings":"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","sourcesContent":["import { Form, Formik } from \"formik\";\r\nimport { useState } from \"react\";\r\nimport RegisterInput from \"../inputs/registerInput\";\r\nimport * as Yup from \"yup\";\r\nimport DateOfBirthSelect from \"./DateOfBirthSelect\";\r\nimport GenderSelect from \"./GenderSelect\";\r\nimport DotLoader from \"react-spinners/DotLoader\";\r\nimport axios from \"axios\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport Cookies from \"js-cookie\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nexport default function RegisterForm({ setVisible }) {\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate();\r\n  const userInfos = {\r\n    first_name: \"\",\r\n    last_name: \"\",\r\n    email: \"\",\r\n    password: \"\",\r\n    bYear: new Date().getFullYear(),\r\n    bMonth: new Date().getMonth() + 1,\r\n    bDay: new Date().getDate(),\r\n    gender: \"\",\r\n  };\r\n  const [user, setUser] = useState(userInfos);\r\n  const {\r\n    first_name,\r\n    last_name,\r\n    email,\r\n    password,\r\n    bYear,\r\n    bMonth,\r\n    bDay,\r\n    gender,\r\n  } = user;\r\n  const yearTemp = new Date().getFullYear();\r\n  const handleRegisterChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setUser({ ...user, [name]: value });\r\n  };\r\n  const years = Array.from(new Array(108), (val, index) => yearTemp - index);\r\n  const months = Array.from(new Array(12), (val, index) => 1 + index);\r\n  const getDays = () => {\r\n    return new Date(bYear, bMonth, 0).getDate();\r\n  };\r\n  const days = Array.from(new Array(getDays()), (val, index) => 1 + index);\r\n  const registerValidation = Yup.object({\r\n    first_name: Yup.string()\r\n      .required(\"What's your First name ?\")\r\n      .min(2, \"Fisrt name must be between 2 and 16 characters.\")\r\n      .max(16, \"Fisrt name must be between 2 and 16 characters.\")\r\n      .matches(/^[aA-zZ]+$/, \"Numbers and special characters are not allowed.\"),\r\n    last_name: Yup.string()\r\n      .required(\"What's your Last name ?\")\r\n      .min(2, \"Last name must be between 2 and 16 characters.\")\r\n      .max(16, \"Last name must be between 2 and 16 characters.\")\r\n      .matches(/^[aA-zZ]+$/, \"Numbers and special characters are not allowed.\"),\r\n    email: Yup.string()\r\n      .required(\r\n        \"You'll need this when you log in and if you ever need to reset your password.\"\r\n      )\r\n      .email(\"Enter a valid email address.\"),\r\n    password: Yup.string()\r\n      .required(\r\n        \"Enter a combination of at least six numbers,letters and punctuation marks(such as ! and &).\"\r\n      )\r\n      .min(6, \"Password must be atleast 6 characters.\")\r\n      .max(36, \"Password can't be more than 36 characters\"),\r\n  });\r\n  const [dateError, setDateError] = useState(\"\");\r\n  const [genderError, setGenderError] = useState(\"\");\r\n\r\n  const [error, setError] = useState(\"\");\r\n  const [success, setSuccess] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const registerSubmit = async () => {\r\n    try {\r\n      const { data } = await axios.post(\r\n        `${process.env.REACT_APP_BACKEND_URL}/register`,\r\n        {\r\n          first_name,\r\n          last_name,\r\n          email,\r\n          password,\r\n          bYear,\r\n          bMonth,\r\n          bDay,\r\n          gender,\r\n        }\r\n      );\r\n      setError(\"\");\r\n      setSuccess(data.message);\r\n      const { message, ...rest } = data;\r\n      setTimeout(() => {\r\n        dispatch({ type: \"LOGIN\", payload: rest });\r\n        Cookies.set(\"user\", JSON.stringify(rest));\r\n        navigate(\"/\");\r\n      }, 2000);\r\n    } catch (error) {\r\n      setLoading(false);\r\n      setSuccess(\"\");\r\n      setError(error.response.data.message);\r\n    }\r\n  };\r\n  return (\r\n    <div className=\"blur\">\r\n      <div className=\"register\">\r\n        <div className=\"register_header\">\r\n          <i className=\"exit_icon\" onClick={() => setVisible(false)}></i>\r\n          <span>Sign Up</span>\r\n          <span>it's quick and easy</span>\r\n        </div>\r\n        <Formik\r\n          enableReinitialize\r\n          initialValues={{\r\n            first_name,\r\n            last_name,\r\n            email,\r\n            password,\r\n            bYear,\r\n            bMonth,\r\n            bDay,\r\n            gender,\r\n          }}\r\n          validationSchema={registerValidation}\r\n          onSubmit={() => {\r\n            let current_date = new Date();\r\n            let picked_date = new Date(bYear, bMonth - 1, bDay);\r\n            let atleast14 = new Date(1970 + 14, 0, 1);\r\n            let noMoreThan70 = new Date(1970 + 70, 0, 1);\r\n            if (current_date - picked_date < atleast14) {\r\n              setDateError(\r\n                \"it looks like you(ve enetered the wrong info.Please make sure that you use your real date of birth.\"\r\n              );\r\n            } else if (current_date - picked_date > noMoreThan70) {\r\n              setDateError(\r\n                \"it looks like you(ve enetered the wrong info.Please make sure that you use your real date of birth.\"\r\n              );\r\n            } else if (gender === \"\") {\r\n              setDateError(\"\");\r\n              setGenderError(\r\n                \"Please choose a gender. You can change who can see this later.\"\r\n              );\r\n            } else {\r\n              setDateError(\"\");\r\n              setGenderError(\"\");\r\n              registerSubmit();\r\n            }\r\n          }}\r\n        >\r\n          {(formik) => (\r\n            <Form className=\"register_form\">\r\n              <div className=\"reg_line\">\r\n                <RegisterInput\r\n                  type=\"text\"\r\n                  placeholder=\"First name\"\r\n                  name=\"first_name\"\r\n                  onChange={handleRegisterChange}\r\n                />\r\n                <RegisterInput\r\n                  type=\"text\"\r\n                  placeholder=\"Surname\"\r\n                  name=\"last_name\"\r\n                  onChange={handleRegisterChange}\r\n                />\r\n              </div>\r\n              <div className=\"reg_line\">\r\n                <RegisterInput\r\n                  type=\"text\"\r\n                  placeholder=\"Mobile number or email address\"\r\n                  name=\"email\"\r\n                  onChange={handleRegisterChange}\r\n                />\r\n              </div>\r\n              <div className=\"reg_line\">\r\n                <RegisterInput\r\n                  type=\"password\"\r\n                  placeholder=\"New password\"\r\n                  name=\"password\"\r\n                  onChange={handleRegisterChange}\r\n                />\r\n              </div>\r\n              <div className=\"reg_col\">\r\n                <div className=\"reg_line_header\">\r\n                  Date of birth <i className=\"info_icon\"></i>\r\n                </div>\r\n                <DateOfBirthSelect\r\n                  bDay={bDay}\r\n                  bMonth={bMonth}\r\n                  bYear={bYear}\r\n                  days={days}\r\n                  months={months}\r\n                  years={years}\r\n                  handleRegisterChange={handleRegisterChange}\r\n                  dateError={dateError}\r\n                />\r\n              </div>\r\n              <div className=\"reg_col\">\r\n                <div className=\"reg_line_header\">\r\n                  Gender <i className=\"info_icon\"></i>\r\n                </div>\r\n\r\n                <GenderSelect\r\n                  handleRegisterChange={handleRegisterChange}\r\n                  genderError={genderError}\r\n                />\r\n              </div>\r\n              <div className=\"reg_infos\">\r\n                By clicking Sign Up, you agree to our{\" \"}\r\n                <span>Terms, Data Policy &nbsp;</span>\r\n                and <span>Cookie Policy.</span> You may receive SMS\r\n                notifications from us and can opt out at any time.\r\n              </div>\r\n              <div className=\"reg_btn_wrapper\">\r\n                <button className=\"blue_btn open_signup\">Sign Up</button>\r\n              </div>\r\n              <DotLoader color=\"#1876f2\" loading={loading} size={30} />\r\n              {error && <div className=\"error_text\">{error}</div>}\r\n              {success && <div className=\"success_text\">{success}</div>}\r\n            </Form>\r\n          )}\r\n        </Formik>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}