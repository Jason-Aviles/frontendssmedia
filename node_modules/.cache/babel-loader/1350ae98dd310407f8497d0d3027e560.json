{"ast":null,"code":"import _asyncToGenerator from\"/Users/jasonaviles/Desktop/facebook/starter/frontendssmedia/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/jasonaviles/Desktop/facebook/starter/frontendssmedia/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/jasonaviles/Desktop/facebook/starter/frontendssmedia/node_modules/@babel/runtime/regenerator/index.js\";import{useEffect,useRef,useState}from\"react\";import{Return,Search}from\"../../svg\";import useClickOutside from\"../../helpers/clickOutside\";import{addToSearchHistory,getSearchHistory,removeFromSearch,search}from\"../../functions/user\";import{Link}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function SearchMenu(_ref){var color=_ref.color,setShowSearchMenu=_ref.setShowSearchMenu,token=_ref.token;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),iconVisible=_useState2[0],setIconVisible=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),searchTerm=_useState4[0],setSearchTerm=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),results=_useState6[0],setResults=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),searchHistory=_useState8[0],setSearchHistory=_useState8[1];var menu=useRef(null);var input=useRef(null);useClickOutside(menu,function(){setShowSearchMenu(false);});useEffect(function(){getHistory();},[]);var getHistory=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getSearchHistory(token);case 2:res=_context.sent;setSearchHistory(res);case 4:case\"end\":return _context.stop();}}},_callee);}));return function getHistory(){return _ref2.apply(this,arguments);};}();useEffect(function(){input.current.focus();},[]);var searchHandler=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(searchTerm===\"\")){_context2.next=4;break;}setResults(\"\");_context2.next=8;break;case 4:_context2.next=6;return search(searchTerm,token);case 6:res=_context2.sent;setResults(res);case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function searchHandler(){return _ref3.apply(this,arguments);};}();var addToSearchHistoryHandler=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(searchUser){var res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return addToSearchHistory(searchUser,token);case 2:res=_context3.sent;getHistory();case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function addToSearchHistoryHandler(_x){return _ref4.apply(this,arguments);};}();var handleRemove=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(searchUser){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:removeFromSearch(searchUser,token);getHistory();case 2:case\"end\":return _context4.stop();}}},_callee4);}));return function handleRemove(_x2){return _ref5.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"header_left search_area scrollbar\",ref:menu,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"search_wrap\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"header_logo\",children:/*#__PURE__*/_jsx(\"div\",{className:\"circle hover1\",onClick:function onClick(){setShowSearchMenu(false);},children:/*#__PURE__*/_jsx(Return,{color:color})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"search\",onClick:function onClick(){input.current.focus();},children:[iconVisible&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Search,{color:color})}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search Facebook\",ref:input,value:searchTerm,onChange:function onChange(e){return setSearchTerm(e.target.value);},onKeyUp:searchHandler,onFocus:function onFocus(){setIconVisible(false);},onBlur:function onBlur(){setIconVisible(true);}})]})]}),results==\"\"&&/*#__PURE__*/_jsxs(\"div\",{className:\"search_history_header\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Recent searches\"}),/*#__PURE__*/_jsx(\"a\",{children:\"Edit\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"search_history scrollbar\",children:searchHistory&&results==\"\"&&searchHistory.sort(function(a,b){return new Date(b.createdAt)-new Date(a.createdAt);}).map(function(user){return/*#__PURE__*/_jsxs(\"div\",{className:\"search_user_item hover1\",children:[/*#__PURE__*/_jsxs(Link,{className:\"flex\",to:\"/profile/\".concat(user.user.username),onClick:function onClick(){return addToSearchHistoryHandler(user.user._id);},children:[/*#__PURE__*/_jsx(\"img\",{src:user.user.picture,alt:\"\"}),/*#__PURE__*/_jsxs(\"span\",{children:[user.user.first_name,\" \",user.user.last_name]})]}),/*#__PURE__*/_jsx(\"i\",{className:\"exit_icon\",onClick:function onClick(){handleRemove(user.user._id);}})]},user._id);})}),/*#__PURE__*/_jsx(\"div\",{className:\"search_results scrollbar\",children:results&&results.map(function(user){return/*#__PURE__*/_jsxs(Link,{to:\"/profile/\".concat(user.username),className:\"search_user_item hover1\",onClick:function onClick(){return addToSearchHistoryHandler(user._id);},children:[/*#__PURE__*/_jsx(\"img\",{src:user.picture,alt:\"\"}),/*#__PURE__*/_jsxs(\"span\",{children:[user.first_name,\" \",user.last_name]})]},user._id);})})]});}","map":{"version":3,"sources":["/Users/jasonaviles/Desktop/facebook/starter/frontendssmedia/src/components/header/SearchMenu.js"],"names":["useEffect","useRef","useState","Return","Search","useClickOutside","addToSearchHistory","getSearchHistory","removeFromSearch","search","Link","SearchMenu","color","setShowSearchMenu","token","iconVisible","setIconVisible","searchTerm","setSearchTerm","results","setResults","searchHistory","setSearchHistory","menu","input","getHistory","res","current","focus","searchHandler","addToSearchHistoryHandler","searchUser","handleRemove","e","target","value","sort","a","b","Date","createdAt","map","user","username","_id","picture","first_name","last_name"],"mappings":"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","sourcesContent":["import { useEffect, useRef, useState } from \"react\";\r\nimport { Return, Search } from \"../../svg\";\r\nimport useClickOutside from \"../../helpers/clickOutside\";\r\nimport {\r\n  addToSearchHistory,\r\n  getSearchHistory,\r\n  removeFromSearch,\r\n  search,\r\n} from \"../../functions/user\";\r\nimport { Link } from \"react-router-dom\";\r\nexport default function SearchMenu({ color, setShowSearchMenu, token }) {\r\n  const [iconVisible, setIconVisible] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n  const [results, setResults] = useState([]);\r\n  const [searchHistory, setSearchHistory] = useState([]);\r\n  const menu = useRef(null);\r\n  const input = useRef(null);\r\n  useClickOutside(menu, () => {\r\n    setShowSearchMenu(false);\r\n  });\r\n  useEffect(() => {\r\n    getHistory();\r\n  }, []);\r\n  const getHistory = async () => {\r\n    const res = await getSearchHistory(token);\r\n    setSearchHistory(res);\r\n  };\r\n  useEffect(() => {\r\n    input.current.focus();\r\n  }, []);\r\n  const searchHandler = async () => {\r\n    if (searchTerm === \"\") {\r\n      setResults(\"\");\r\n    } else {\r\n      const res = await search(searchTerm, token);\r\n      setResults(res);\r\n    }\r\n  };\r\n  const addToSearchHistoryHandler = async (searchUser) => {\r\n    const res = await addToSearchHistory(searchUser, token);\r\n    getHistory();\r\n  };\r\n  const handleRemove = async (searchUser) => {\r\n    removeFromSearch(searchUser, token);\r\n    getHistory();\r\n  };\r\n  return (\r\n    <div className=\"header_left search_area scrollbar\" ref={menu}>\r\n      <div className=\"search_wrap\">\r\n        <div className=\"header_logo\">\r\n          <div\r\n            className=\"circle hover1\"\r\n            onClick={() => {\r\n              setShowSearchMenu(false);\r\n            }}\r\n          >\r\n            <Return color={color} />\r\n          </div>\r\n        </div>\r\n        <div\r\n          className=\"search\"\r\n          onClick={() => {\r\n            input.current.focus();\r\n          }}\r\n        >\r\n          {iconVisible && (\r\n            <div>\r\n              <Search color={color} />\r\n            </div>\r\n          )}\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Search Facebook\"\r\n            ref={input}\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e.target.value)}\r\n            onKeyUp={searchHandler}\r\n            onFocus={() => {\r\n              setIconVisible(false);\r\n            }}\r\n            onBlur={() => {\r\n              setIconVisible(true);\r\n            }}\r\n          />\r\n        </div>\r\n      </div>\r\n      {results == \"\" && (\r\n        <div className=\"search_history_header\">\r\n          <span>Recent searches</span>\r\n          <a>Edit</a>\r\n        </div>\r\n      )}\r\n      <div className=\"search_history scrollbar\">\r\n        {searchHistory &&\r\n          results == \"\" &&\r\n          searchHistory\r\n            .sort((a, b) => {\r\n              return new Date(b.createdAt) - new Date(a.createdAt);\r\n            })\r\n            .map((user) => (\r\n              <div className=\"search_user_item hover1\" key={user._id}>\r\n                <Link\r\n                  className=\"flex\"\r\n                  to={`/profile/${user.user.username}`}\r\n                  onClick={() => addToSearchHistoryHandler(user.user._id)}\r\n                >\r\n                  <img src={user.user.picture} alt=\"\" />\r\n                  <span>\r\n                    {user.user.first_name} {user.user.last_name}\r\n                  </span>\r\n                </Link>\r\n                <i\r\n                  className=\"exit_icon\"\r\n                  onClick={() => {\r\n                    handleRemove(user.user._id);\r\n                  }}\r\n                ></i>\r\n              </div>\r\n            ))}\r\n      </div>\r\n      <div className=\"search_results scrollbar\">\r\n        {results &&\r\n          results.map((user) => (\r\n            <Link\r\n              to={`/profile/${user.username}`}\r\n              className=\"search_user_item hover1\"\r\n              onClick={() => addToSearchHistoryHandler(user._id)}\r\n              key={user._id}\r\n            >\r\n              <img src={user.picture} alt=\"\" />\r\n              <span>\r\n                {user.first_name} {user.last_name}\r\n              </span>\r\n            </Link>\r\n          ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}