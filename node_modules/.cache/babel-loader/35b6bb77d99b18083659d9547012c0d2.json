{"ast":null,"code":"import _toConsumableArray from\"/Users/jasonaviles/Desktop/facebook/starter/frontendssmedia/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/Users/jasonaviles/Desktop/facebook/starter/frontendssmedia/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/jasonaviles/Desktop/facebook/starter/frontendssmedia/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/jasonaviles/Desktop/facebook/starter/frontendssmedia/node_modules/@babel/runtime/regenerator/index.js\";import{Link}from\"react-router-dom\";import\"./style.css\";import Moment from\"react-moment\";import{Dots,Public}from\"../../svg\";import ReactsPopup from\"./ReactsPopup\";import{useEffect,useRef,useState}from\"react\";import CreateComment from\"./CreateComment\";import PostMenu from\"./PostMenu\";import{comment,getReacts,reactPost}from\"../../functions/post\";import Comment from\"./Comment\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Post(_ref){var _post$images;var post=_ref.post,user=_ref.user,profile=_ref.profile;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),visible=_useState2[0],setVisible=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showMenu=_useState4[0],setShowMenu=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),reacts=_useState6[0],setReacts=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),check=_useState8[0],setCheck=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),total=_useState10[0],setTotal=_useState10[1];var _useState11=useState(1),_useState12=_slicedToArray(_useState11,2),count=_useState12[0],setCount=_useState12[1];var _useState13=useState(),_useState14=_slicedToArray(_useState13,2),checkSaved=_useState14[0],setCheckSaved=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),comments=_useState16[0],setComments=_useState16[1];useEffect(function(){getPostReacts();},[post]);useEffect(function(){setComments(post===null||post===void 0?void 0:post.comments);},[post]);var getPostReacts=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getReacts(post._id,user.token);case 2:res=_context.sent;setReacts(res.reacts);setCheck(res.check);setTotal(res.total);setCheckSaved(res.checkSaved);case 7:case\"end\":return _context.stop();}}},_callee);}));return function getPostReacts(){return _ref2.apply(this,arguments);};}();var reactHandler=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(type){var index,_index,index1;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:reactPost(post._id,type,user.token);if(check==type){setCheck();index=reacts.findIndex(function(x){return x.react==check;});if(index!==-1){setReacts([].concat(_toConsumableArray(reacts),[reacts[index].count=--reacts[index].count]));setTotal(function(prev){return--prev;});}}else{setCheck(type);_index=reacts.findIndex(function(x){return x.react==type;});index1=reacts.findIndex(function(x){return x.react==check;});if(_index!==-1){setReacts([].concat(_toConsumableArray(reacts),[reacts[_index].count=++reacts[_index].count]));setTotal(function(prev){return++prev;});console.log(reacts);}if(index1!==-1){setReacts([].concat(_toConsumableArray(reacts),[reacts[index1].count=--reacts[index1].count]));setTotal(function(prev){return--prev;});console.log(reacts);}}case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function reactHandler(_x){return _ref3.apply(this,arguments);};}();var showMore=function showMore(){setCount(function(prev){return prev+3;});};var postRef=useRef(null);return/*#__PURE__*/_jsxs(\"div\",{className:\"post\",style:{width:\"\".concat(profile&&\"100%\")},ref:postRef,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"post_header\",children:[/*#__PURE__*/_jsxs(Link,{to:\"/profile/\".concat(post.user.username),className:\"post_header_left\",children:[/*#__PURE__*/_jsx(\"img\",{src:post.user.picture,alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"header_col\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"post_profile_name\",children:[post.user.first_name,\" \",post.user.last_name,/*#__PURE__*/_jsxs(\"div\",{className:\"updated_p\",children:[post.type==\"profilePicture\"&&\"updated \".concat(post.user.gender===\"male\"?\"his\":\"her\",\" profile picture\"),post.type==\"coverPicture\"&&\"updated \".concat(post.user.gender===\"male\"?\"his\":\"her\",\" cover picture\")]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"post_profile_privacy_date\",children:[/*#__PURE__*/_jsx(Moment,{fromNow:true,interval:30,children:post.createdAt}),\". \",/*#__PURE__*/_jsx(Public,{color:\"#828387\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"post_header_right hover1\",onClick:function onClick(){return setShowMenu(function(prev){return!prev;});},children:/*#__PURE__*/_jsx(Dots,{color:\"#828387\"})})]}),post.background?/*#__PURE__*/_jsx(\"div\",{className:\"post_bg\",style:{backgroundImage:\"url(\".concat(post.background,\")\")},children:/*#__PURE__*/_jsx(\"div\",{className:\"post_bg_text\",children:post.text})}):post.type===null?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"post_text\",children:post.text}),post.images&&post.images.length&&/*#__PURE__*/_jsxs(\"div\",{className:post.images.length===1?\"grid_1\":post.images.length===2?\"grid_2\":post.images.length===3?\"grid_3\":post.images.length===4?\"grid_4\":post.images.length>=5&&\"grid_5\",children:[post.images.slice(0,5).map(function(image,i){return/*#__PURE__*/_jsx(\"img\",{src:image.url,alt:\"\",className:\"img-\".concat(i)},i);}),post.images.length>5&&/*#__PURE__*/_jsxs(\"div\",{className:\"more-pics-shadow\",children:[\"+\",post.images.length-5]})]})]}):post.type===\"profilePicture\"?/*#__PURE__*/_jsxs(\"div\",{className:\"post_profile_wrap\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"post_updated_bg\",children:/*#__PURE__*/_jsx(\"img\",{src:post.user.cover,alt:\"\"})}),/*#__PURE__*/_jsx(\"img\",{src:post.images[0].url,alt:\"\",className:\"post_updated_picture\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"post_cover_wrap\",children:/*#__PURE__*/_jsx(\"img\",{src:post.images[0].url,alt:\"\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"post_infos\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"reacts_count\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"reacts_count_imgs\",children:reacts&&reacts.sort(function(a,b){return b.count-a.count;}).slice(0,3).map(function(react,i){return react.count>0&&/*#__PURE__*/_jsx(\"img\",{src:\"../../../reacts/\".concat(react.react,\".svg\"),alt:\"\"},i);})}),/*#__PURE__*/_jsx(\"div\",{className:\"reacts_count_num\",children:total>0&&total})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"to_right\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"comments_count\",children:[comments.length,\" comments\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"share_count\",children:\"0 share\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"post_actions\",children:[/*#__PURE__*/_jsx(ReactsPopup,{visible:visible,setVisible:setVisible,reactHandler:reactHandler}),/*#__PURE__*/_jsxs(\"div\",{className:\"post_action hover1\",onMouseOver:function onMouseOver(){setTimeout(function(){setVisible(true);},500);},onMouseLeave:function onMouseLeave(){setTimeout(function(){setVisible(false);},500);},onClick:function onClick(){return reactHandler(check?check:\"like\");},children:[check?/*#__PURE__*/_jsx(\"img\",{src:\"../../../reacts/\".concat(check,\".svg\"),alt:\"\",className:\"small_react\",style:{width:\"18px\"}}):/*#__PURE__*/_jsx(\"i\",{className:\"like_icon\"}),/*#__PURE__*/_jsx(\"span\",{style:{color:\"\\n          \\n          \".concat(check===\"like\"?\"#4267b2\":check===\"love\"?\"#f63459\":check===\"haha\"?\"#f7b125\":check===\"sad\"?\"#f7b125\":check===\"wow\"?\"#f7b125\":check===\"angry\"?\"#e4605a\":\"\",\"\\n          \")},children:check?check:\"Like\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"post_action hover1\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"comment_icon\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Comment\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"post_action hover1\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"share_icon\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Share\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"comments_wrap\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"comments_order\"}),/*#__PURE__*/_jsx(CreateComment,{user:user,postId:post._id,setComments:setComments,setCount:setCount}),comments&&comments.sort(function(a,b){return new Date(b.commentAt)-new Date(a.commentAt);}).slice(0,count).map(function(comment,i){return/*#__PURE__*/_jsx(Comment,{comment:comment},i);}),count<comments.length&&/*#__PURE__*/_jsx(\"div\",{className:\"view_comments\",onClick:function onClick(){return showMore();},children:\"View more comments\"})]}),showMenu&&/*#__PURE__*/_jsx(PostMenu,{userId:user.id,postUserId:post.user._id,imagesLength:post===null||post===void 0?void 0:(_post$images=post.images)===null||_post$images===void 0?void 0:_post$images.length,setShowMenu:setShowMenu,postId:post._id,token:user.token,checkSaved:checkSaved,setCheckSaved:setCheckSaved,images:post.images,postRef:postRef})]});}","map":{"version":3,"sources":["/Users/jasonaviles/Desktop/facebook/starter/frontendssmedia/src/components/post/index.js"],"names":["Link","Moment","Dots","Public","ReactsPopup","useEffect","useRef","useState","CreateComment","PostMenu","comment","getReacts","reactPost","Comment","Post","post","user","profile","visible","setVisible","showMenu","setShowMenu","reacts","setReacts","check","setCheck","total","setTotal","count","setCount","checkSaved","setCheckSaved","comments","setComments","getPostReacts","_id","token","res","reactHandler","type","index","findIndex","x","react","prev","index1","console","log","showMore","postRef","width","username","picture","first_name","last_name","gender","createdAt","background","backgroundImage","text","images","length","slice","map","image","i","url","cover","sort","a","b","setTimeout","color","Date","commentAt","id"],"mappings":"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","sourcesContent":["import { Link } from \"react-router-dom\";\r\nimport \"./style.css\";\r\nimport Moment from \"react-moment\";\r\nimport { Dots, Public } from \"../../svg\";\r\nimport ReactsPopup from \"./ReactsPopup\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport CreateComment from \"./CreateComment\";\r\nimport PostMenu from \"./PostMenu\";\r\nimport { comment, getReacts, reactPost } from \"../../functions/post\";\r\nimport Comment from \"./Comment\";\r\nexport default function Post({ post, user, profile }) {\r\n  const [visible, setVisible] = useState(false);\r\n  const [showMenu, setShowMenu] = useState(false);\r\n  const [reacts, setReacts] = useState();\r\n  const [check, setCheck] = useState();\r\n  const [total, setTotal] = useState(0);\r\n  const [count, setCount] = useState(1);\r\n  const [checkSaved, setCheckSaved] = useState();\r\n  const [comments, setComments] = useState([]);\r\n  useEffect(() => {\r\n    getPostReacts();\r\n  }, [post]);\r\n  useEffect(() => {\r\n    setComments(post?.comments);\r\n  }, [post]);\r\n\r\n  const getPostReacts = async () => {\r\n    const res = await getReacts(post._id, user.token);\r\n    setReacts(res.reacts);\r\n    setCheck(res.check);\r\n    setTotal(res.total);\r\n    setCheckSaved(res.checkSaved);\r\n  };\r\n\r\n  const reactHandler = async (type) => {\r\n    reactPost(post._id, type, user.token);\r\n    if (check == type) {\r\n      setCheck();\r\n      let index = reacts.findIndex((x) => x.react == check);\r\n      if (index !== -1) {\r\n        setReacts([...reacts, (reacts[index].count = --reacts[index].count)]);\r\n        setTotal((prev) => --prev);\r\n      }\r\n    } else {\r\n      setCheck(type);\r\n      let index = reacts.findIndex((x) => x.react == type);\r\n      let index1 = reacts.findIndex((x) => x.react == check);\r\n      if (index !== -1) {\r\n        setReacts([...reacts, (reacts[index].count = ++reacts[index].count)]);\r\n        setTotal((prev) => ++prev);\r\n        console.log(reacts);\r\n      }\r\n      if (index1 !== -1) {\r\n        setReacts([...reacts, (reacts[index1].count = --reacts[index1].count)]);\r\n        setTotal((prev) => --prev);\r\n        console.log(reacts);\r\n      }\r\n    }\r\n  };\r\n  const showMore = () => {\r\n    setCount((prev) => prev + 3);\r\n  };\r\n  const postRef = useRef(null);\r\n  return (\r\n    <div\r\n      className=\"post\"\r\n      style={{ width: `${profile && \"100%\"}` }}\r\n      ref={postRef}\r\n    >\r\n      <div className=\"post_header\">\r\n        <Link\r\n          to={`/profile/${post.user.username}`}\r\n          className=\"post_header_left\"\r\n        >\r\n          <img src={post.user.picture} alt=\"\" />\r\n          <div className=\"header_col\">\r\n            <div className=\"post_profile_name\">\r\n              {post.user.first_name} {post.user.last_name}\r\n              <div className=\"updated_p\">\r\n                {post.type == \"profilePicture\" &&\r\n                  `updated ${\r\n                    post.user.gender === \"male\" ? \"his\" : \"her\"\r\n                  } profile picture`}\r\n                {post.type == \"coverPicture\" &&\r\n                  `updated ${\r\n                    post.user.gender === \"male\" ? \"his\" : \"her\"\r\n                  } cover picture`}\r\n              </div>\r\n            </div>\r\n            <div className=\"post_profile_privacy_date\">\r\n              <Moment fromNow interval={30}>\r\n                {post.createdAt}\r\n              </Moment>\r\n              . <Public color=\"#828387\" />\r\n            </div>\r\n          </div>\r\n        </Link>\r\n        <div\r\n          className=\"post_header_right hover1\"\r\n          onClick={() => setShowMenu((prev) => !prev)}\r\n        >\r\n          <Dots color=\"#828387\" />\r\n        </div>\r\n      </div>\r\n      {post.background ? (\r\n        <div\r\n          className=\"post_bg\"\r\n          style={{ backgroundImage: `url(${post.background})` }}\r\n        >\r\n          <div className=\"post_bg_text\">{post.text}</div>\r\n        </div>\r\n      ) : post.type === null ? (\r\n        <>\r\n          <div className=\"post_text\">{post.text}</div>\r\n          {post.images && post.images.length && (\r\n            <div\r\n              className={\r\n                post.images.length === 1\r\n                  ? \"grid_1\"\r\n                  : post.images.length === 2\r\n                  ? \"grid_2\"\r\n                  : post.images.length === 3\r\n                  ? \"grid_3\"\r\n                  : post.images.length === 4\r\n                  ? \"grid_4\"\r\n                  : post.images.length >= 5 && \"grid_5\"\r\n              }\r\n            >\r\n              {post.images.slice(0, 5).map((image, i) => (\r\n                <img src={image.url} key={i} alt=\"\" className={`img-${i}`} />\r\n              ))}\r\n              {post.images.length > 5 && (\r\n                <div className=\"more-pics-shadow\">\r\n                  +{post.images.length - 5}\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </>\r\n      ) : post.type === \"profilePicture\" ? (\r\n        <div className=\"post_profile_wrap\">\r\n          <div className=\"post_updated_bg\">\r\n            <img src={post.user.cover} alt=\"\" />\r\n          </div>\r\n          <img\r\n            src={post.images[0].url}\r\n            alt=\"\"\r\n            className=\"post_updated_picture\"\r\n          />\r\n        </div>\r\n      ) : (\r\n        <div className=\"post_cover_wrap\">\r\n          <img src={post.images[0].url} alt=\"\" />\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"post_infos\">\r\n        <div className=\"reacts_count\">\r\n          <div className=\"reacts_count_imgs\">\r\n            {reacts &&\r\n              reacts\r\n                .sort((a, b) => {\r\n                  return b.count - a.count;\r\n                })\r\n                .slice(0, 3)\r\n                .map(\r\n                  (react, i) =>\r\n                    react.count > 0 && (\r\n                      <img\r\n                        src={`../../../reacts/${react.react}.svg`}\r\n                        alt=\"\"\r\n                        key={i}\r\n                      />\r\n                    )\r\n                )}\r\n          </div>\r\n          <div className=\"reacts_count_num\">{total > 0 && total}</div>\r\n        </div>\r\n        <div className=\"to_right\">\r\n          <div className=\"comments_count\">{comments.length} comments</div>\r\n          <div className=\"share_count\">0 share</div>\r\n        </div>\r\n      </div>\r\n      <div className=\"post_actions\">\r\n        <ReactsPopup\r\n          visible={visible}\r\n          setVisible={setVisible}\r\n          reactHandler={reactHandler}\r\n        />\r\n        <div\r\n          className=\"post_action hover1\"\r\n          onMouseOver={() => {\r\n            setTimeout(() => {\r\n              setVisible(true);\r\n            }, 500);\r\n          }}\r\n          onMouseLeave={() => {\r\n            setTimeout(() => {\r\n              setVisible(false);\r\n            }, 500);\r\n          }}\r\n          onClick={() => reactHandler(check ? check : \"like\")}\r\n        >\r\n          {check ? (\r\n            <img\r\n              src={`../../../reacts/${check}.svg`}\r\n              alt=\"\"\r\n              className=\"small_react\"\r\n              style={{ width: \"18px\" }}\r\n            />\r\n          ) : (\r\n            <i className=\"like_icon\"></i>\r\n          )}\r\n          <span\r\n            style={{\r\n              color: `\r\n          \r\n          ${\r\n            check === \"like\"\r\n              ? \"#4267b2\"\r\n              : check === \"love\"\r\n              ? \"#f63459\"\r\n              : check === \"haha\"\r\n              ? \"#f7b125\"\r\n              : check === \"sad\"\r\n              ? \"#f7b125\"\r\n              : check === \"wow\"\r\n              ? \"#f7b125\"\r\n              : check === \"angry\"\r\n              ? \"#e4605a\"\r\n              : \"\"\r\n          }\r\n          `,\r\n            }}\r\n          >\r\n            {check ? check : \"Like\"}\r\n          </span>\r\n        </div>\r\n        <div className=\"post_action hover1\">\r\n          <i className=\"comment_icon\"></i>\r\n          <span>Comment</span>\r\n        </div>\r\n        <div className=\"post_action hover1\">\r\n          <i className=\"share_icon\"></i>\r\n          <span>Share</span>\r\n        </div>\r\n      </div>\r\n      <div className=\"comments_wrap\">\r\n        <div className=\"comments_order\"></div>\r\n        <CreateComment\r\n          user={user}\r\n          postId={post._id}\r\n          setComments={setComments}\r\n          setCount={setCount}\r\n        />\r\n        {comments &&\r\n          comments\r\n            .sort((a, b) => {\r\n              return new Date(b.commentAt) - new Date(a.commentAt);\r\n            })\r\n            .slice(0, count)\r\n            .map((comment, i) => <Comment comment={comment} key={i} />)}\r\n        {count < comments.length && (\r\n          <div className=\"view_comments\" onClick={() => showMore()}>\r\n            View more comments\r\n          </div>\r\n        )}\r\n      </div>\r\n      {showMenu && (\r\n        <PostMenu\r\n          userId={user.id}\r\n          postUserId={post.user._id}\r\n          imagesLength={post?.images?.length}\r\n          setShowMenu={setShowMenu}\r\n          postId={post._id}\r\n          token={user.token}\r\n          checkSaved={checkSaved}\r\n          setCheckSaved={setCheckSaved}\r\n          images={post.images}\r\n          postRef={postRef}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}